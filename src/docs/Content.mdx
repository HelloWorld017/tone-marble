import ImageToneMarbleMain from './assets/images/tone-marble-main.webp';
import ImageTM07Structure from './assets/images/tm07-structure.png';
import VideoDemo from './assets/videos/tonemarble-demo.mp4';
import { CirclesPanout } from './components/CirclesPanout';
import { Footer } from './components/Footer';
import { FullWidthImage } from './components/FullWidthImage';
import { SiriWave } from './components/SiriWave';
import { SoundGallery } from './components/SoundGallery';
import { MotivationImages } from './components/MotivationImages'
import { Video } from './components/Video';

<section>
  # TM-07 <span>: An unrealistic instrument</span>

  <a className="cta" href="../">Try it now</a>
</section>

<section>
  ## <i>01</i> A Modern Artifact <span>_ Precision engineering meets organic tranquility</span>

  The TM-07, while being an instrument, is a piece of desk sculpture designed to inspire.  
  The design language strips away the unnecessary, leaving only a sleek form factor that bridges the gap between a high-fidelity audio tool and a modernist art object.  
  It looks as beautiful silent as it sounds when active.
</section>

<br />
<FullWidthImage className="main-image" src={ImageToneMarbleMain} />

<section>
  ## <i>02</i> Kinetic Synthesis Engine <span>_ The physics of sound, visualized and heard.</span>
  The heart of the Tone-Marble is a gravity-defying physics engine.
  Tilt your mobile device to release a cascade of virtual marbles.
  As they collide with internal pillars, they trigger a generative soundscape based on three elemental textures: Wind, Glass, and Sand.  
  Your rhythms evolve with the angle of your hand.
</section>


<CirclesPanout />

<section>
  ## <i>03</i> Sympathetic Resonance <span>_ It listens, it harmonizes, it flows.</span>
  The TM-07 creates a dialogue with its player. Utilizing a microphone or MIDI, the device detects your vocal pitch or instrumental input and instantly tunes the virtual marbles to a matching key, creating a seamless harmony.  

  As you increase the velocity of the rolling marbles, the TM-07 introduces a dynamic layer of lo-fi crackle and rhythmic static, syncing the background noise to the physical speed of the simulation. It is the perfect companion for finding focus in chaos.
</section>

<SiriWave />

<Footer />

<div style={{ height: "500px" }} />

<section>
**Final Project**  
2025 Fall CTP.40031  
`Yohan Kim`

<br />

Above is the fake landing page illustrating my final project, with a concept of a virtual product from a fictional company.

### Motivation

I wanted to create a polished, yet unrealistic, virtual instrument.
While brainstorming, these influences got into my mind, and helped make my abstract ideas concrete.

<br />
<MotivationImages />
<br />

* **Rainstick** / **Marbles Automata**  
  Provided the core concept.

* **Pinball**  
  Inspired the mechanic of triggering sounds upon marble collisions.

* **Dancing Cactus Plush**  
  Inspired the speech-feedback loop mechanism.

* **Darth Vader Chrome Experiment**  
  Inspired the motion control idea.

* **Teenage Engineering**  
  Inspired the aesthetic design.

* **Shigure Ui**  
  Inspired the power on/off sound by her stream intro clip.  
  Additionally, her streams were excellent background companions for coding.

<br />

Essentially, this project is an experiment to determine if the chaotic nature of physics can sound musical when entropy is reduced â€” specifically by constraining the pitch.  

After conceiving the idea of stochastic sounds tuned to specific pitches, I was unsure if the result would be pleasing.
So I started by implementing a minimal pitch detector, recording the pitches, and synthesizing the output using the ChucK programming language.

And the result is: I became even more uncertain about its viability. The sound was just like the arbitrary noise in the pachinko. Fortunately, after implementing the full project, the outcome was not as bad as I had feared.

### Main Idea

> The TM-07's core concept is a <mark>cascade of marbles</mark>  

The marbles pour out based on tilt of user's smartphone, just like pouring a real container. When a marble collides with a pillar, a sound matching the current chroma feature plays.  
There are three timbres: Winds, Glass, and Sand.  

The chroma feature is derived from pitch detectors or MIDI input.
When you sing, whistle, or directly play a note, the system recognizes the chroma and tunes the synthesizers accordingly.

Time flows when the marbles collide, and the speed of that flow determines the background rhythm or noise that shapes the current soundscape.

You can customize the timbre assigned to each pillar and adjust the intensity of the resulting background noise.

### Sound Gallery
All sounds in this project are synthesized in real-time, from scratch, using the Web Audio API.  
You can preview them below:

</section>
<SoundGallery />
<section>

### Play / Demo Video
Why don't you experience it firsthand?  
<Video src={VideoDemo} />
<a className="cta" href="../">Try it now</a>  
<br />
<br />

### Technical Details
The TM-07 consists of five layers:
<img src={ImageTM07Structure} style={{ width: '100%', maxWidth: '500px' }} alt="Layers" />

* **Chroma Detection Layer**  
  Three chroma detection techniques are used: `Crepe`, `Spice` and `FFT`.  
  Initially, I tested neural pitch detectors (Crepe and Spice), but as their performance was suboptimal (likely because I used trimmed models), I created an ad-hoc FFT chroma detector.  
  You can select the preferred method in the settings.

* **Synthesis Layer**  
  Three synthesizers implemented in WebAudio: `Wind`, `Glass` and `Sand`.
  These utilize additive & subtractive synthesis.  
  Synthesizers for `Lo-Fi Vinyl Scratch`, `Kick & Hi-hat`, and `Power Turn On/Off` are also implemented.
  Actually, no pre-recorded samples are used in this project.

* **Controller Layer**  
  Smartphone's motion data is sent directly to the laptop via WebRTC.
  Internally uses [PeerJS's signaling server](https://status.peerjs.com/), but except that, it is serverless.

* **Physics Layer**  
  Detects collision strength and position, then synthesizes sound with stereo panning. Powered by the rapier3d physics engine.

* **Interface / Visualize Layer**  
  Handles user input and updates the internal state, in 3D. The interface was modeled and rigged in Blender and rendered using react-three.

#### Side Notes

This project took 7 happy days and 3 crunch days.

<div className="twocols">
  <div>
    **Used Web APIs**  

    <span className="taglist">`WebAudio` `WebGL` `WebGPU` `WebMIDI` `WebRTC`</span>
  </div>
  <div>
    **Used Libraries**
    * **UI**  
      <span className="taglist">`react` `react-three` `react-spring` `emotion`</span>

    * **NeuralNets**  
      <span className="taglist">`tensorflowjs`</span>

    * **WebRTC**  
      <span className="taglist">`peerjs`</span>
  </div>
</div>

<br />

### Source Code
You can find the source code here:  
<a className="cta secondary" href="https://github.com/HelloWorld017/tone-marble" target="_blank">Source Code</a>  

</section>

<div style={{ height: "20vh" }} />
